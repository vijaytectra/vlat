<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VLAT Entrance Exam Login</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />

    <!-- Compiled Tailwind CSS -->
    <link rel="stylesheet" href="css/main.css?v=2.0" />
  </head>

  <body class="font-['Inter'] bg-[#FFF6E2]">
    <!-- ROOT GRID -->
    <main class="grid grid-cols-1 lg:grid-cols-[96px_1fr_1fr]">
      <!-- LEFT RED STRIP -->
      <aside class="hidden lg:block w-72 bg-primary relative">
        <button
          onclick="history.back()"
          class="absolute top-6 left-32 z-20 flex items-center gap-2 text-sm font-medium uppercase border border-white/40 rounded-full px-3 py-1 text-[#A3A3A3] backdrop-blur"
        >
          <i class="fas fa-chevron-left text-xs"></i>
          BACK
        </button>
      </aside>

      <section
        class="hidden z-10 lg:flex items-center justify-start h-full px-10 pt-10"
      >
        <img
          src="images/loginimage.png"
          alt="Students attending class"
          class="h-full max-h-[85%] w-auto object-contain"
        />
      </section>

      <!-- FORM COLUMN -->
      <section class="flex items-center justify-center px-4 py-12">
        <div class="w-full max-w-md space-y-3">
          <!-- LOGO -->
          <div class="flex justify-center">
            <img src="images/logo1.svg" class="h-14" />
          </div>

          <!-- TITLE -->
          <div class="text-center space-y-1">
            <h1 class="text-2xl font-bold text-primary">
              VLAT Entrance Exam Login
            </h1>
            <p class="text-sm text-gray-600">
              Use the Login ID and Password sent to your email to access your
              exam dashboard.
            </p>
          </div>

          <!-- FORM CARD -->
          <form id="loginForm" class="bg-primary rounded-3xl p-6 space-y-4">
            <!-- ERROR -->
            <div
              id="errorMessage"
              class="hidden flex items-center gap-2 bg-white text-red-600 text-xs px-3 py-2 rounded-full"
            >
              <i class="fas fa-circle-exclamation"></i>
              <span id="errorText"
                >Please enter both Login ID and Password</span
              >
            </div>

            <!-- LOGIN ID -->
            <div>
              <label class="text-[#F3F4F6] text-sm">Login ID</label>
              <input
                id="loginId"
                type="text"
                placeholder="Enter your Login ID or Email"
                class="mt-1 w-full h-10 placeholder:text-sm border border-[#FFFFFF33] rounded-md bg-[#FFFFFF1A] px-3 text-white placeholder-[#D4D4D4] outline-none"
                required
              />
            </div>

            <!-- PASSWORD -->
            <div>
              <label class="text-[#F3F4F6] text-sm">Password</label>
              <input
                id="password"
                type="password"
                placeholder="Enter your Password"
                class="mt-1 w-full h-10 placeholder:text-sm rounded-md bg-[#FFFFFF1A] px-3 text-white placeholder-[#D4D4D4] outline-none border border-[#FFFFFF33]"
                required
              />
            </div>

            <!-- REMEMBER -->
            <div
              class="flex justify-between items-center text-xs text-gray-200"
            >
              <label class="flex items-center gap-2">
                <input
                  type="checkbox"
                  class="text-[#D4D4D4] font-light w-4 h-4"
                />
                Remember Me
              </label>
              <a href="forgot-password.html" class="text-[#EDCD88] text-light"
                >Forgot Password?</a
              >
            </div>

            <!-- BUTTON -->
            <button
              type="submit"
              id="loginButton"
              class="w-full h-11 bg-[#FFF6E2] text-primary font-medium rounded-lg disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <span id="loginButtonText">Login to Dashboard</span>
              <span id="loginButtonLoader" class="hidden">
                <i class="fas fa-spinner fa-spin"></i> Logging in...
              </span>
            </button>

            <!-- REGISTER -->
            <p class="text-center text-xs text-[#FAFAFA]">
              Donâ€™t have a Login ID?
              <a href="register.html" class="text-[#EDCD88] text-light"
                >Register</a
              >
              here to create your account.
            </p>

            <!-- HELP -->
            <div
              class="border-t border-white/20 pt-3 text-xs text-[#F5F5F5] space-y-2"
            >
              <p class="text-center text-[#F5F5F5]">Need help with login?</p>
              <div class="flex justify-between">
                <span
                  ><i class="fas fa-envelope"></i> admissions@vmls.edu.in</span
                >
                <span><i class="fas fa-phone"></i> +91 73582 01234</span>
              </div>
            </div>
          </form>
        </div>
      </section>
    </main>
    <script type="module">
      import { login } from "./js/auth.js";

      const form = document.getElementById("loginForm");
      const loginIdInput = document.getElementById("loginId");
      const passwordInput = document.getElementById("password");
      const errorMessage = document.getElementById("errorMessage");
      const errorText = document.getElementById("errorText");
      const loginButton = document.getElementById("loginButton");
      const loginButtonText = document.getElementById("loginButtonText");
      const loginButtonLoader = document.getElementById("loginButtonLoader");

      // Hide error message initially
      errorMessage.classList.add("hidden");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Hide error message
        errorMessage.classList.add("hidden");

        // Get form values
        const loginId = loginIdInput.value.trim();
        const password = passwordInput.value;

        // Basic validation
        if (!loginId || !password) {
          showError("Please enter both Login ID and Password");
          return;
        }

        // Show loading state
        loginButton.disabled = true;
        loginButtonText.classList.add("hidden");
        loginButtonLoader.classList.remove("hidden");

        try {
          // Call login API
          const result = await login(loginId, password);

          if (result.success) {
            // Redirect to dashboard
            window.location.href = "dashboard.html";
          } else {
            // Show error message
            showError(result.message || "Login failed. Please try again.");
            loginButton.disabled = false;
            loginButtonText.classList.remove("hidden");
            loginButtonLoader.classList.add("hidden");
          }
        } catch (error) {
          console.error("Login error:", error);
          showError("An error occurred. Please try again.");
          loginButton.disabled = false;
          loginButtonText.classList.remove("hidden");
          loginButtonLoader.classList.add("hidden");
        }
      });

      function showError(message) {
        errorText.textContent = message;
        errorMessage.classList.remove("hidden");
      }
    </script>
  </body>
</html>
